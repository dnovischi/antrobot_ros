# Copyright (C) 2025 Dan Novischi. All rights reserved.
# This software may be modified and distributed under the terms of the
# GNU Lesser General Public License v3 or any later version.

# Odometry Jump Monitor Configuration
# This file contains parameters for detecting and monitoring odometry jumps

odom_monitor:
  ros__parameters:
    # Topic configuration
    wheel_odom_topic: 'odom_wheel'   # Wheel odometry from RDrive
    icp_odom_topic: 'odom'           # ICP odometry from kinematic-icp
    lidar_topic: 'scan'              # Lidar scan input to ICP
    
    # Jump detection thresholds
    max_linear_jump: 0.5        # Maximum position jump in meters (50cm)
    max_angular_jump: 0.785     # Maximum angular jump in radians (45 degrees)
    max_velocity_jump: 2.0      # Maximum velocity change in m/s
    
    # Cross-odometry monitoring
    max_cross_odom_diff: 1.0    # Maximum difference between wheel and ICP odometry (meters)
    
    # Lidar health monitoring
    min_lidar_points: 50        # Minimum points per scan for healthy lidar
    max_lidar_gap_time: 0.2     # Maximum time gap between scans (seconds)
    
    # Timestamp synchronization monitoring
    timestamp_sync_threshold: 0.5  # Warn only if timestamp difference > this (seconds)
    
    # Advanced detection settings
    velocity_window_size: 5     # Number of samples for velocity smoothing
    position_filter_alpha: 0.9  # Position filtering coefficient (0-1, higher = less filtering)
    
    # Diagnostic publishing rate
    diagnostic_rate: 1.0        # Hz - how often to publish diagnostics
    
    # Logging verbosity (for development/debugging)
    verbose_logging: true       # Enable detailed jump logging
    log_tf_state: true          # Capture TF tree state on jumps
    log_lidar_stats: true       # Include lidar statistics in jump reports
